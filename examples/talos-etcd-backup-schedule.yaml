---
# Create a secret with S3 credentials
apiVersion: v1
kind: Secret
metadata:
  name: my-s3-credentials
  namespace: default
type: Opaque
stringData:
  accessKeyID: "YOUR_ACCESS_KEY_ID"
  secretAccessKey: "YOUR_SECRET_ACCESS_KEY"
---
# Example TalosEtcdBackupSchedule resource
# This will create periodic etcd backups on a schedule
apiVersion: talos.alperen.cloud/v1alpha1
kind: TalosEtcdBackupSchedule
metadata:
  name: talosetcdbackupschedule-sample
spec:
  # Cron schedule for backups (daily at 2 AM)
  schedule: "0 2 * * *"
  
  # Number of successful backups to retain (older ones will be deleted)
  retention: 5
  
  # Set to true to pause the backup schedule
  paused: false
  
  # Template for creating TalosEtcdBackup resources
  backupTemplate:
    spec:
      # Reference to the TalosControlPlane to backup
      talosControlPlaneRef:
        name: taloscontrolplane-sample
      
      # S3 storage configuration
      backupStorage:
        s3:
          # S3 bucket name
          bucket: my-etcd-backups
          
          # AWS region
          region: us-west-2
          
          # Reference to secret containing AWS access key ID
          accessKeyID:
            name: my-s3-credentials
            key: accessKeyID
          
          # Reference to secret containing AWS secret access key
          secretAccessKey:
            name: my-s3-credentials
            key: secretAccessKey
          
          # Optional: Custom S3 endpoint (for S3-compatible storage like MinIO)
          # endpoint: https://minio.example.com
          
          # Optional: Skip TLS verification (useful for self-signed certificates)
          # insecureSkipTLSVerify: false
